!function(){function t(t){return"undefined"!=typeof t.value?"value":"undefined"!=typeof t.text?"text":"undefined"!=typeof t.textContent?"textContent":"innerText"}function e(){}function n(){}function i(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("StartToStart",e)<=0)return 0;if(t.compareEndPoints("StartToEnd",e)>=0)return n;for(var i=0;t.compareEndPoints("StartToStart",e)>0;++i,t.moveStart("character",-1));return i}function r(t,e){var n=e.text.replace(/\r/g,"").length;if(t.compareEndPoints("EndToEnd",e)>=0)return n;if(t.compareEndPoints("EndToStart",e)<=0)return 0;for(var i=0;t.compareEndPoints("EndToStart",e)>0;++i,t.moveEnd("character",-1));return i}function o(){}function a(){}function s(t,e){if(t.firstChild)return t.firstChild;if(t.nextSibling)return t.nextSibling;if(t===e)return null;for(;t.parentNode;){if(t=t.parentNode,t==e)return null;if(t.nextSibling)return t.nextSibling}return null}function l(t,e,n,i){if(!(0>=e)){var r=t[n?"startContainer":"endContainer"];for(3==r.nodeType&&(e+=t[n?"startOffset":"endOffset"]);r;){if(3==r.nodeType){var o=r.nodeValue.length;if(o>=e){if(t[n?"setStart":"setEnd"](r,e),e==o){for(var a=s(r,i);a&&3==a.nodeType&&0==a.nodeValue.length;a=s(a,i))t[n?"setStartAfter":"setEndAfter"](a);a&&1==a.nodeType&&"BR"==a.nodeName&&t[n?"setStartAfter":"setEndAfter"](a)}return}t[n?"setStartAfter":"setEndAfter"](r),e-=o}r=s(r,i)}}}function u(t,e){return t.compareBoundaryPoints(b,e)<=0?0:t.compareBoundaryPoints(y,e)>=0?e.toString().length:(t=t.cloneRange(),t.setEnd(e.endContainer,e.endOffset),e.toString().replace(/\r/g,"").length-t.toString().replace(/\r/g,"").length)}function c(t,e){return t.compareBoundaryPoints(v,e)>=0?e.toString().length:t.compareBoundaryPoints(g,e)<=0?0:(t=t.cloneRange(),t.setStart(e.startContainer,e.startOffset),t.toString().replace(/\r/g,"").length)}function d(){}var h="onfocusin"in document.createElement("input")?"focusin":"focus",p=document.createElement("div");p.appendChild(document.createTextNode("x-")),p.appendChild(document.createTextNode("x")),p.normalize();var f=3==p.firstChild.length;bililiteRange=function(e,i){function r(t){t&&9==t.which?s._nativeSelect(s._nativeRange(e.bililiteRangeSelection)):e.bililiteRangeSelection=s._nativeSelection()}var s;if(i)s=new d;else if(window.getSelection&&e.setSelectionRange)try{e.selectionStart,s=new o}catch(l){s=new d}else s=window.getSelection?new a:document.selection?new n:new d;if(s._el=e,s._doc=e.ownerDocument,s._win="defaultView"in s._doc?s._doc.defaultView:s._doc.parentWindow,s._textProp=t(e),s._bounds=[0,s.length()],!("bililiteRangeMouseDown"in s._doc)){var u={_el:s._doc};s._doc.bililiteRangeMouseDown=!1,bililiteRange.fn.listen.call(u,"mousedown",function(){s._doc.bililiteRangeMouseDown=!0}),bililiteRange.fn.listen.call(u,"mouseup",function(){s._doc.bililiteRangeMouseDown=!1})}if("bililiteRangeSelection"in e||(r(),"onbeforedeactivate"in e?s.listen("beforedeactivate",r):s.listen("mouseup",r).listen("keyup",r),s.listen(h,function(){s._doc.bililiteRangeMouseDown||s._nativeSelect(s._nativeRange(e.bililiteRangeSelection))})),!("oninput"in e)){var c=function(){s.dispatch({type:"input",bubbles:!0})};s.listen("keyup",c),s.listen("cut",c),s.listen("paste",c),s.listen("drop",c),e.oninput="patched"}return s},e.prototype={length:function(){return this._el[this._textProp].replace(/\r/g,"").length},bounds:function(t){if(bililiteRange.bounds[t])this._bounds=bililiteRange.bounds[t].apply(this);else{if(!t){var e=[Math.max(0,Math.min(this.length(),this._bounds[0])),Math.max(0,Math.min(this.length(),this._bounds[1]))];return e[1]=Math.max(e[0],e[1]),e}this._bounds=t}return this},select:function(){var t=this._el.bililiteRangeSelection=this.bounds();return this._el===this._doc.activeElement&&this._nativeSelect(this._nativeRange(t)),this.dispatch({type:"select",bubbles:!0}),this},text:function(t,e){if(arguments.length){var n=this.bounds();this._el;return this.dispatch({type:"beforeinput",bubbles:!0,data:t,bounds:n}),this._nativeSetText(t,this._nativeRange(n)),"start"==e?this.bounds([n[0],n[0]]):"end"==e?this.bounds([n[0]+t.length,n[0]+t.length]):"all"==e&&this.bounds([n[0],n[0]+t.length]),this.dispatch({type:"input",bubbles:!0,data:t,bounds:n}),this}return this._nativeGetText(this._nativeRange(this.bounds())).replace(/\r/g,"")},insertEOL:function(){return this._nativeEOL(),this._bounds=[this._bounds[0]+1,this._bounds[0]+1],this},sendkeys:function(t){function e(t,e){/^{[^}]*}$/.test(e)&&(e=e.slice(1,-1));for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);t.dispatch({type:"keypress",bubbles:!0,keyCode:i,which:i,charCode:i})}t.text(e,"end")}var n=this;return this.data().sendkeysOriginalText=this.text(),this.data().sendkeysBounds=void 0,t.replace(/{[^}]*}|[^{]+|{/g,function(t){(bililiteRange.sendkeys[t]||e)(n,t,e)}),this.bounds(this.data().sendkeysBounds),this.dispatch({type:"sendkeys",which:t}),this},top:function(){return this._nativeTop(this._nativeRange(this.bounds()))},scrollIntoView:function(t){var e=this.top();return(this._el.scrollTop>e||this._el.scrollTop+this._el.clientHeight<e)&&(t?t.call(this._el,e):this._el.scrollTop=e),this},wrap:function(t){return this._nativeWrap(t,this._nativeRange(this.bounds())),this},selection:function(t){return arguments.length?this.bounds("selection").text(t,"end").select():this.bounds("selection").text()},clone:function(){return bililiteRange(this._el).bounds(this.bounds())},all:function(t){return arguments.length?(this.dispatch({type:"beforeinput",bubbles:!0,data:t}),this._el[this._textProp]=t,this.dispatch({type:"input",bubbles:!0,data:t}),this):this._el[this._textProp].replace(/\r/g,"")},element:function(){return this._el},dispatch:function(t){t=t||{};var e=document.createEvent?document.createEvent("CustomEvent"):this._doc.createEventObject();e.initCustomEvent&&e.initCustomEvent(t.type,!!t.bubbles,!!t.cancelable,t.detail);for(var n in t)e[n]=t[n];var i=this._el;return setTimeout(function(){try{i.dispatchEvent?i.dispatchEvent(e):i.fireEvent("on"+t.type,document.createEventObject())}catch(n){var r=i["listen"+t.type];if(r)for(var o=0;o<r.length;++o)r[o].call(i,e)}},0),this},listen:function(t,e){var n=this._el;if(n.addEventListener)n.addEventListener(t,e);else{n.attachEvent("on"+t,e);var i=n["listen"+t]=n["listen"+t]||[];i.push(e)}return this},dontlisten:function(t,e){var n=this._el;if(n.removeEventListener)n.removeEventListener(t,e);else try{n.detachEvent("on"+t,e)}catch(i){var r=n["listen"+t];if(r)for(var o=0;o<r.length;++o)r[o]===e&&(r[o]=function(){})}return this}},bililiteRange.fn=e.prototype,bililiteRange.extend=function(t){for(fn in t)e.prototype[fn]=t[fn]},bililiteRange.bounds={all:function(){return[0,this.length()]},start:function(){return[0,0]},end:function(){return[this.length(),this.length()]},selection:function(){return this._el===this._doc.activeElement?(this.bounds("all"),this._nativeSelection()):this._el.bililiteRangeSelection}},bililiteRange.sendkeys={"{enter}":function(t){t.dispatch({type:"keypress",bubbles:!0,keyCode:"\n",which:"\n",charCode:"\n"}),t.insertEOL()},"{tab}":function(t,e,n){n(t,"	")},"{newline}":function(t,e,n){n(t,"\n")},"{backspace}":function(t){var e=t.bounds();e[0]==e[1]&&t.bounds([e[0]-1,e[0]]),t.text("","end")},"{del}":function(t){var e=t.bounds();e[0]==e[1]&&t.bounds([e[0],e[0]+1]),t.text("","end")},"{rightarrow}":function(t){var e=t.bounds();e[0]==e[1]&&++e[1],t.bounds([e[1],e[1]])},"{leftarrow}":function(t){var e=t.bounds();e[0]==e[1]&&--e[0],t.bounds([e[0],e[0]])},"{selectall}":function(t){t.bounds("all")},"{selection}":function(t){for(var e=t.data().sendkeysOriginalText,n=0;n<e.length;++n){var i=e.charCodeAt(n);t.dispatch({type:"keypress",bubbles:!0,keyCode:i,which:i,charCode:i})}t.text(e,"end")},"{mark}":function(t){t.data().sendkeysBounds=t.bounds()}},bililiteRange.sendkeys["{Enter}"]=bililiteRange.sendkeys["{enter}"],bililiteRange.sendkeys["{Backspace}"]=bililiteRange.sendkeys["{backspace}"],bililiteRange.sendkeys["{Delete}"]=bililiteRange.sendkeys["{del}"],bililiteRange.sendkeys["{ArrowRight}"]=bililiteRange.sendkeys["{rightarrow}"],bililiteRange.sendkeys["{ArrowLeft}"]=bililiteRange.sendkeys["{leftarrow}"],n.prototype=new e,n.prototype._nativeRange=function(t){var e;return"INPUT"==this._el.tagName?e=this._el.createTextRange():(e=this._doc.body.createTextRange(),e.moveToElementText(this._el)),t&&(t[1]<0&&(t[1]=0),t[0]>this.length()&&(t[0]=this.length()),t[1]<e.text.replace(/\r/g,"").length&&(e.moveEnd("character",-1),e.moveEnd("character",t[1]-e.text.replace(/\r/g,"").length)),t[0]>0&&e.moveStart("character",t[0])),e},n.prototype._nativeSelect=function(t){t.select()},n.prototype._nativeSelection=function(){var t=this._nativeRange(),e=this.length(),n=this._doc.selection.createRange();try{return[i(n,t),r(n,t)]}catch(o){return n.parentElement().sourceIndex<this._el.sourceIndex?[0,0]:[e,e]}},n.prototype._nativeGetText=function(t){return t.text},n.prototype._nativeSetText=function(t,e){e.text=t},n.prototype._nativeEOL=function(){"value"in this._el?this.text("\n"):this._nativeRange(this.bounds()).pasteHTML("\n<br/>")},n.prototype._nativeTop=function(t){var e=this._nativeRange([0,0]);return t.boundingTop-e.boundingTop},n.prototype._nativeWrap=function(t,e){var n=document.createElement("div");n.appendChild(t);var i=n.innerHTML.replace("><",">"+e.htmlText+"<");e.pasteHTML(i)},o.prototype=new e,o.prototype._nativeRange=function(t){return t||[0,this.length()]},o.prototype._nativeSelect=function(t){this._el.setSelectionRange(t[0],t[1])},o.prototype._nativeSelection=function(){return[this._el.selectionStart,this._el.selectionEnd]},o.prototype._nativeGetText=function(t){return this._el.value.substring(t[0],t[1])},o.prototype._nativeSetText=function(t,e){var n=this._el.value;this._el.value=n.substring(0,e[0])+t+n.substring(e[1])},o.prototype._nativeEOL=function(){this.text("\n")},o.prototype._nativeTop=function(t){var e=this._el.cloneNode(!0);e.style.visibility="hidden",e.style.position="absolute",this._el.parentNode.insertBefore(e,this._el),e.style.height="1px",e.value=this._el.value.slice(0,t[0]);var n=e.scrollHeight;return e.value="X",n-=e.scrollHeight,e.parentNode.removeChild(e),n},o.prototype._nativeWrap=function(){throw new Error("Cannot wrap in a text element")},a.prototype=new e,a.prototype._nativeRange=function(t){var e=this._doc.createRange();return e.selectNodeContents(this._el),t&&(l(e,t[0],!0,this._el),e.collapse(!0),l(e,t[1]-t[0],!1,this._el)),e},a.prototype._nativeSelect=function(t){this._win.getSelection().removeAllRanges(),this._win.getSelection().addRange(t)},a.prototype._nativeSelection=function(){var t=this._nativeRange();if(0==this._win.getSelection().rangeCount)return[this.length(),this.length()];var e=this._win.getSelection().getRangeAt(0);return[u(e,t),c(e,t)]},a.prototype._nativeGetText=function(t){return String.prototype.slice.apply(this._el.textContent,this.bounds())},a.prototype._nativeSetText=function(t,e){e.deleteContents(),e.insertNode(this._doc.createTextNode(t)),f&&this._el.normalize()},a.prototype._nativeEOL=function(){var t=this._nativeRange(this.bounds());t.deleteContents();var e=this._doc.createElement("br");e.setAttribute("_moz_dirty",""),t.insertNode(e),t.insertNode(this._doc.createTextNode("\n")),t.collapse(!1)},a.prototype._nativeTop=function(t){if(0==this.length)return 0;if(""==t.toString()){var e=this._doc.createTextNode("X");t.insertNode(e)}var n=this._nativeRange([0,1]),i=t.getBoundingClientRect().top-n.getBoundingClientRect().top;return e&&e.parentNode.removeChild(e),i},a.prototype._nativeWrap=function(t,e){e.surroundContents(t)};var b=0,g=1,v=2,y=3;d.prototype=new e,d.prototype._nativeRange=function(t){return t||[0,this.length()]},d.prototype._nativeSelect=function(t){},d.prototype._nativeSelection=function(){return[0,0]},d.prototype._nativeGetText=function(t){return this._el[this._textProp].substring(t[0],t[1])},d.prototype._nativeSetText=function(t,e){var n=this._el[this._textProp];this._el[this._textProp]=n.substring(0,e[0])+t+n.substring(e[1])},d.prototype._nativeEOL=function(){this.text("\n")},d.prototype._nativeTop=function(){return 0},d.prototype._nativeWrap=function(){throw new Error("Wrapping not implemented")};var m=[];bililiteRange.fn.data=function(){var t=this.element().bililiteRangeData;return void 0==t&&(t=this.element().bililiteRangeData=m.length,m[t]=new _(this)),m[t]};try{Object.defineProperty({},"foo",{});var _=function(t){Object.defineProperty(this,"values",{value:{}}),Object.defineProperty(this,"sourceRange",{value:t}),Object.defineProperty(this,"toJSON",{value:function(){var t={};for(var e in _.prototype)e in this.values&&(t[e]=this.values[e]);return t}}),Object.defineProperty(this,"all",{get:function(){var t={};for(var e in _.prototype)t[e]=this[e];return t}})};_.prototype={},Object.defineProperty(_.prototype,"values",{value:{}}),Object.defineProperty(_.prototype,"monitored",{value:{}}),bililiteRange.data=function(t,e){e=e||{};var n=Object.getOwnPropertyDescriptor(_.prototype,t)||{};"enumerable"in e&&(n.enumerable=!!e.enumerable),"enumerable"in n||(n.enumerable=!0),"value"in e&&(_.prototype.values[t]=e.value),"monitored"in e&&(_.prototype.monitored[t]=e.monitored),n.configurable=!0,n.get=function(){return t in this.values?this.values[t]:_.prototype.values[t]},n.set=function(e){this.values[t]=e,_.prototype.monitored[t]&&this.sourceRange.dispatch({type:"bililiteRangeData",bubbles:!0,detail:{name:t,value:e}})},Object.defineProperty(_.prototype,t,n)}}catch(x){_=function(t){this.sourceRange=t},_.prototype={},bililiteRange.data=function(t,e){"value"in e&&(_.prototype[t]=e.value)}}}(),Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=arguments.length>=2?arguments[1]:void 0,r=0;n>r;r++)r in e&&t.call(i,e[r],r,e)}),bililiteRange&&function(){function t(t){var n=t.data().undos;if(n)return n;var r=new e(t);return i(t),r}function e(t){this.text=t.all();var e=t.data().undos;e&&this.text==e.text||(this.bounds=t.bounds("selection").bounds(),this.undo=this,this.redo=this,e&&(this.undo=e,e.redo=this),t.data().undos=this)}function n(t,e,n){n.dispatch({type:e}),t=t[e],t.lastevent=e,n.data().undos=t,n.all(t.text).bounds(t.bounds).select()}function i(n){n.listen("input",function(){var i=t(n),r=(n.element(),i.lastevent);switch(delete i.lastevent,r){case"undo":case"redo":return;case"keypress":"keypress"==i.penultimateevent&&(n.data().undos=i.undo)}new e(n).penultimateevent=r}).listen("keypress",function(e){if(!(e.which<32||e.altKey||e.altGraphKey||e.ctrlKey||e.metaKey)){var i=n.bounds("selection").bounds();if(i[0]==i[1]){var r=t(n);r.bounds[0]==i[0]&&(r.lastevent="keypress")}}})}bililiteRange.data("undos",{enumerable:!1}),bililiteRange.fn.undo=function(e){0==arguments.length&&(e=1);var i=t(this);if(e>0)for(var r=0;e>r;++r)n(i,"undo",this);else if(0>e)for(r=0;r>e;--r)n(i,"redo",this);return this},bililiteRange.undo=function(t){bililiteRange(t.target).undo(),t.preventDefault()},bililiteRange.redo=function(t){bililiteRange(t.target).undo(-1),t.preventDefault()}}(),bililiteRange&&function(){function t(t){return new RegExp(t.source,"g"+(t.ignoreCase?"i":"")+(t.multiline?"m":""))}function e(t,e){return t&&t.index==e[0]&&t[0].length==e[1]-e[0]}function n(t,e){for(var n=t.length,i=e.length,r=0;i>r&&n>r&&e.charAt(r)==t.charAt(r);++r);var o=r;for(r=0;i>r&&n>r;++r){var a=i-r-1,s=n-r-1;if(o>a||o>s)break;if(e.charAt(a)!=t.charAt(s))break}var l=n-r,u=i-r;return{bounds:[o,l],data:e.slice(o,u)}}function i(t,e){return t.replace(/\n/g,"\n"+e)}function r(t,e,n,i){n=Math.round(n),e=Math.round(e),(!isFinite(n)||1>n)&&(n=4),(isNaN(e)||0>e)&&(e=1),isFinite(e)||(e="");var r=new RegExp((i?"(^)":"(\\n)")+"(?:	| {"+n+"}){1,"+e+"}","g");return t.replace(r,"$1")}bililiteRange.bounds.EOL=function(){return this.bounds("startbounds"),this.findprimitive(/$/gm,this.bounds())?this.bounds():this.find(/$/m,!0).bounds()},bililiteRange.bounds.BOL=function(){return this.bounds("startbounds"),this.findprimitive(/^/gm,this.bounds())?this.bounds():this.findBack(/^/m,!0).bounds()},bililiteRange.bounds.line=function(){this.bounds("BOL");var t=this.bounds()[0];return this.bounds("EOL"),[t,this.bounds()[1]]},bililiteRange.bounds.startbounds=function(){return[this.bounds()[0],this.bounds()[0]]},bililiteRange.bounds.endbounds=function(){return[this.bounds()[1],this.bounds()[1]]};var o=bililiteRange.fn.text;bililiteRange.fn.text=function(t,e,n){return arguments.length?(n&&(t=i(t,this.indentation())),o.call(this,t,e)):o.call(this)},bililiteRange.extend({find:function(n,i,r){void 0!==n.nowrap&&(i=n.nowrap),n=t(n);var o=this.bounds();if(r)a="findprimitiveback",s=[0,o[0]],l=[0,o[0]-1];else var a="findprimitive",s=[o[0],Number.MAX_VALUE],l=[o[0]+1,Number.MAX_VALUE];var u=this[a](n,s);return e(u,o)&&(u=this[a](n,l)),u||i||(u=this[a](n,[0,Number.MAX_VALUE])),e(u,o)&&(u=!1),this.match=u,u&&this.bounds([u.index,u.index+u[0].length]),this},findBack:function(t,e){return this.find(t,e,!0)},indentation:function(){return/^\s*/.exec(this.clone().bounds("line").text())[0]},indent:function(t){var e=this.text(),n=i(e,t),r=this.bounds();return this.text(n),this.clone().bounds("BOL").text(t),this.bounds([r[0]+t.length,r[1]+t.length+n.length-e.length])},unindent:function(t,e){e=e||this.data().tabSize||8;var n=this.text(),i=r(n,t,e,!1),o=this.bounds(),a=i.length-n.length;this.text(i).bounds([o[0],o[1]+a]);var s=this.clone().bounds("line");n=s.text(),i=r(n,t,e,!0),s.text(i);var l=i.length-n.length;return this.bounds([Math.max(s.bounds()[0],o[0]+l),o[1]+a+l])},line:function(t){if(arguments.length){if(t=parseInt(t),isNaN(t))return this;if(t>this.all().split("\n").length)return this.bounds("end");if(1>t)return this.bounds([0,0]);var e=this.bounds();this.bounds("BOL");var n=e[0]-this.bounds()[0],i=new RegExp("(.*\\n){"+(t-1)+"}(.{"+n+"}|.*$)","m");return this.bounds("all").find(i).bounds("endbounds")}return this.all().slice(0,this.bounds()[0]).split("\n").length},live:function(t){var e=this;if(0==arguments.length||t){if(this._oldtext=e.all(),this._inputHandler)return this;this._inputHandler=function(t){var i,r,o,a=e.all();if(a!=e._oldtext){if(!t.bounds){var s=n(e._oldtext,a);t.bounds=s.bounds,t.data=s.data}i=t.bounds[0],r=t.bounds[1],o=t.bounds[0]+t.data.length,e._oldtext=a,e._bounds[0]<=i||(e._bounds[0]>r?e._bounds[0]+=o-r:e._bounds[0]=o),e._bounds[1]<i||(e._bounds[1]>=r?e._bounds[1]+=o-r:e._bounds[1]=i)}},e.listen("input",e._inputHandler)}else e.dontlisten("input",e._inputHandler),delete e._inputHandler;return this},findprimitive:function(t,e){var n=this.all();t.lastIndex=e[0];var i=t.exec(n);return!i||i.index+i[0].length>e[1]?!1:i},findprimitiveback:function(t,e){var n=!1;do{var i=n;n=this.findprimitive(t,e),e[0]=n.index+1}while(n);return i}}),bililiteRange.diff=n}(),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var n=0,i=this.length;i>n;++n)t.call(e,this[n],n,this)}),function(t){function e(t){return d[t]||(d[t]="hotkeys"+ ++h)}function n(e,n){var i="";return t.map(e.split(" "),function(t){return i+=" "+t,new RegExp("^"+i+"$",n?"i":"")})}function r(n,i){var r="."+e(t.keymap.normalizeList(i));return n.replace(/(\S)(\s)|$/g,"$1"+r+"$2")}t.keymap=function(e){return t.keymap.normalize(e).keymap},t.keymap.normalize=function(e){if(null==e.keymap){var n=e.key,i=e.shiftKey,r=e.ctrlKey,o=e.altKey,a=e.metaKey,s=r&&o;if(null!=n){if(/^(?:shift|control|meta|alt)$/i.test(n))return e;var c=u.normal.indexOf(n);i&&-1!==c&&(n=u.shift.charAt(c))}else{var d=null!=e.which?e.which:null!=e.charCode?e.charCode:e.keyCode;n=l[d],"number"==typeof n&&(n=i&&s&&0!==u.shift_alt.charCodeAt(n)?u.shift_alt.charAt(n):s&&0!=u.alt.charCodeAt(n)?u.alt.charAt(n):i&&0!=u.shift.charCodeAt(n)?u.shift.charAt(n):u.normal.charAt(n))}if(null==n)return e;-1!==u.shift_alt.indexOf(n)&&(i=o=r=!1),-1!==u.shift.indexOf(n)&&(i=!1),-1!==u.alt.indexOf(n)&&(o=r=!1),e.keymap=n,a&&(e.keymap="~"+e.keymap),o&&(e.keymap="%"+e.keymap),r&&(e.keymap="^"+e.keymap),i&&(e.keymap="+"+e.keymap)}return e.keymap=t.keymap.normalizeString(e.keymap),e.shiftKey=e.ctrlKey=e.altKey=!1,e.key=e.keymap.replace(/^([+^%~]*)(.+)/,function(t,n,i){return(/\+/.test(n)||-1!==u.shift.indexOf(i)||-1!==u.shift_alt.indexOf(i))&&(e.shiftKey=!0),(/\^/.test(n)||-1!==u.alt.indexOf(i)||-1!==u.shift_alt.indexOf(i))&&(e.ctrlKey=!0),(/%/.test(n)||-1!==u.alt.indexOf(i)||-1!==u.shift_alt.indexOf(i))&&(e.altKey=!0),/~/.test(n)&&(e.metaKey=!0),i}),"Spacebar"==e.key&&(e.key=" "),e};var o=t.map("Backspace CapsLock Delete Enter Escape Insert NumLock Tab Spacebar PageUp PageDown End Home ArrowLeft ArrowUp ArrowRight ArrowDown".split(" "),function(t){return{alias:new RegExp("\\b"+t+"\\b","i"),key:t}}),a={apps:"ContextMenu",menu:"ContextMenu","^<(.*)>$":"$1","\\b(?:k|num_)(\\w+)":"$1","{(\\w+)}":"$1",bksp:"Backspace",bs:"Backspace",del:"Delete",esc:"Escape",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",downarrow:"ArrowDown",leftarrow:"ArrowLeft",rightarrow:"ArrowRight",uparrow:"ArrowUp",add:"+",subtract:"-",multiply:"*",divide:"/","s(hift)?[+-]":"+","c(trl)?[+-]":"^","m(eta)?[+-]":"~","a(lt)?[+-]":"%",decimal:".",minus:"-",point:".",lt:"<","#(\\d+)":"F$1",page_up:"pgup",page_down:"pgdn","num\\+":"+","num-":"-","num\\*":"*","num/":"/","^\\+(\\w)$":function(t,e){return e.toUpperCase()}," ":"Spacebar","([+^%~]+)(.)":function(t,e,n){return(/\+/.test(e)?"+":"")+(/\^/.test(e)?"^":"")+(/%/.test(e)?"%":"")+(/~/.test(e)?"~":"")+n}};for(alias in a){var s=a[alias];/^\w/.test(alias)&&(alias="\\b"+alias),/\w$/.test(alias)&&(alias+="\\b"),o.push({alias:new RegExp(alias,"i"),key:s})}t.keymap.normalizeString=function(t){return o.forEach(function(e){t=t.replace(e.alias,e.key)}),t},t.keymap.normalizeList=function(e){return t.trim(t.map(e.split(/\s+/),t.keymap.normalizeString).join(" "))};var l={32:" ",8:"Backspace",20:"CapsLock",93:"ContextMenu",46:"Delete",13:"Enter",27:"Escape",45:"Insert",144:"NumLock",9:"Tab"};for("PageUp PageDown End Home ArrowLeft ArrowUp ArrowRight ArrowDown".split(" ").forEach(function(t,e){l[e+33]=t}),"0123456789*+,-./".split("").forEach(function(t,e){l[e+96]=t}),i=1;i<=12;++i)l[i+111]="F"+i;[192,49,50,51,52,53,54,55,56,57,48,189,187,220,81,87,69,82,84,89,85,73,79,80,219,221,65,83,68,70,71,72,74,75,76,186,222,90,88,67,86,66,78,77,188,190,191].forEach(function(t,e){l[t]=e}),l[59]=l[189];var u,c=Array(48).join(String.fromCharCode(0));t.keymap.setlayout=function(t){u={normal:c,shift:c,alt:c,shift_alt:c};for(layout in t)if("string"==typeof t[layout])u[layout]=t[layout];else for(i in t[layout])i=parseInt(i),u[layout]=u[layout].slice(0,i)+t[layout][i]+u[layout].substring(i+t[layout][i].length);var e=u.shift.split("");u.normal.split("").forEach(function(t,n){0===e[n].charCodeAt(0)&&t.toUpperCase()!==t&&(e[n]=t.toUpperCase())}),u.shift=e.join("")},t.keymap.setlayout({normal:"`1234567890-=\\qwertyuiop[]asdfghjkl;'zxcvbnm,./",shift:{0:"~!@#$%^&*()_+|",24:"{}",35:':"',44:"<>?"}});var d={},h=0;["keydown","keyup"].forEach(function(i){t.event.fixHooks[i]={props:"char charCode code key keyCode keymap hotkeys".split(" "),filter:t.keymap.normalize},t.event.special[i]=t.event.special[i]||{},t.event.special[i].trigger=t.keymap.normalize,t.event.special[i].add=function(i){if(i.data&&i.data.keys){var r=i.data.keys;if(i.namespace=i.namespace.split(".").concat(e(r)).sort().join("."),"string"==typeof r)r=n(t.keymap.normalizeList(r).replace(/[.*+?^=!:${}()|\[\]\/\\]/g,"\\$&"));else{if(!(r instanceof RegExp))return;r=n(r.source,r.ignoreCase)}var o=i.handler,a="";i.handler=function(e){var n=t(this),s=t.keymap(e);if(s)for(a+=" "+s;a;){var l=a.split(" ").length-1;if(r[l-1].test(a)){var u=a.slice(1);return l==r.length?(e.hotkeys=u,n.trigger("keymapcomplete",[u]),a="",o.apply(this,arguments)):(n.trigger("keymapprefix",[u]),!!i.data.allowDefault)}a=a.replace(/ \S+/,"")}}}}});var p=t.event.remove;t.event.remove=function(e,n,i,o){if(void 0===i&&t.isPlainObject(o)&&o.keys)var a=[e,r(n,o.keys)];else a=t.isPlainObject(i)&&i.keys?[e,r(n,i.keys),void 0,o]:arguments;return p.apply(this,a)}}(jQuery),function(t){t.fn.sendkeys=function(t){return t=t.replace(/([^{])\n/g,"$1{enter}"),this.each(function(){bililiteRange(this).bounds("selection").sendkeys(t).select(),this.focus()})},t.event.special.keydown=t.event.special.keydown||{},t.event.special.keydown._default=function(e){if(e.isTrusted)return!1;if(e.ctrlKey||e.altKey||e.metaKey)return!1;if(null==e.key)return!1;var n=e.target;if(n.isContentEditable||"INPUT"==n.nodeName||"TEXTAREA"==n.nodeName){var i=e.key;return i.length>1&&"{"!=i.charAt(0)&&(i="{"+i+"}"),t(n).sendkeys(i),!0}return!1}}(jQuery);